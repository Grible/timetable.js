!function(t,e){"function"==typeof define&&define.amd?define(["exports"],e):e("undefined"!=typeof exports?exports:t.syncscroll={})}(this,function(t){var e="Width",n="Height",o="Top",r="Left",i="scroll",a="client",s=[],c=function(){var t,c,l,d,u,f=document.getElementsByClassName("syncscroll");for(u in s)if(s.hasOwnProperty(u))for(t=0;t<s[u].length;t++)s[u][t].removeEventListener("scroll",s[u][t].syn,0);for(t=0;t<f.length;t++)if(d=0,l=f[t],u=l.getAttribute("name")){for(l=l.scroller||l,s[u]||(s[u]=[]),c=0;c<s[u].length;c++)s[u][c]==l&&(d=1);d||s[u].push(l),l.eX=l.eY=0,function(t,c){t.addEventListener("scroll",t.syn=function(){var l,d,u=s[c],f=t[i+r],h=t[i+o],m=f/(t[i+e]-t[a+e]),p=h/(t[i+n]-t[a+n]),v=0,E=0;for(f!=t.eX&&(v=1,t.eX=f),h!=t.eY&&(E=1,t.eY=h),d=0;d<u.length;d++)l=u[d],l!=t&&(v&&(f=Math.round(m*(l[i+e]-l[a+e])),l.eX=l[i+r]=f),E&&(h=Math.round(p*(l[i+n]-l[a+n])),l.eY=l[i+o]=h))},0)}(l,u)}};"complete"==document.readyState?c():window.addEventListener("load",c,0),t.reset=c});var Timetable=function(){this.scope={hourStart:9,hourEnd:17},this.locations=[],this.events=[]};Timetable.Renderer=function(t){if(!(t instanceof Timetable))throw new Error("Initialize renderer using a Timetable");this.timetable=t},function(){function t(t,n){return e(t)&&e(n)}function e(t){return n(t)&&o(t)}function n(t){return t===parseInt(t,10)}function o(t){return t>=0&&t<24}function r(t,e){return e.findIndex(function(e){return e.id===t})!==-1}function i(t,e){var n=t instanceof Date&&e instanceof Date,o=t<e;return n&&o}function a(t,e){return e>=t?e-t:24+e-t}function s(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function c(t){var e=t<10?"0":"";return e+t+":00"}Timetable.prototype={setScope:function(e,n){if(!t(e,n))throw new RangeError("Timetable scope should consist of (start, end) in whole hours from 0 to 23");return this.scope.hourStart=e,this.scope.hourEnd=n,this},addLocations:function(t){function e(){return t instanceof Array}var n=this.locations;if(!e())throw new Error("Tried to add locations in wrong format");return t.forEach(function(t){if(r(t,n))throw new Error("Location already exists");n.push(t)}),this},addLocation:function(t){function e(){return t instanceof Object}var n=this.locations;if(!e())throw new Error("Tried to add locations in wrong format");if(r(t,n))throw new Error("Location already exists");return n.push(t),this},addEvent:function(t,e,n,o,a){if(!r(e,this.locations))throw console.log(e),new Error("Unknown location");if(!i(n,o))throw new Error("Invalid time range: "+JSON.stringify([n,o]));var s="[object Object]"===Object.prototype.toString.call(a);return this.events.push({name:t,location:e,startDate:n,endDate:o,options:s?a:void 0}),this}},Timetable.Renderer.prototype={draw:function(t){function e(t){if(null===t)throw new Error("Timetable container not found")}function n(t){var e=t.appendChild(document.createElement("aside")),n=e.appendChild(document.createElement("ul"));o(n)}function o(t){for(var e=0;e<p.locations.length;e++){var n=t.appendChild(document.createElement("li")),o=n.appendChild(document.createElement("span"));o.className="row-heading",o.textContent=p.locations[e].name}}function r(t){var e=t.appendChild(document.createElement("section")),n=i(e),o=e.appendChild(document.createElement("time"));o.className="syncscroll",o.setAttribute("name","scrollheader");var r=n.firstChild.offsetWidth+"px";l(o,r)}function i(t){var e=t.appendChild(document.createElement("header"));e.className="syncscroll",e.setAttribute("name","scrollheader");for(var n=e.appendChild(document.createElement("ul")),o=!1,r=!1,i=p.scope.hourStart;!o;){var a=n.appendChild(document.createElement("li")),s=a.appendChild(document.createElement("span"));s.className="time-label",s.textContent=c(i),i!==p.scope.hourEnd||p.scope.hourStart===p.scope.hourEnd&&!r||(o=!0),24===++i&&(i=0,r=!0)}return e}function l(t,e){var n=t.appendChild(document.createElement("ul"));n.style.width=e,n.className="room-timeline";for(var o=0;o<p.locations.length;o++){var r=n.appendChild(document.createElement("li"));d(p.locations[o],r)}}function d(t,e){for(var n=0;n<p.events.length;n++){var o=p.events[n];o.location===t.id&&u(o,e)}}function u(t,e){var n,o,r,i=void 0!==t.options,a=!1;i&&(n=void 0!==t.options.url,o=void 0!==t.options["class"],r=void 0!==t.options.data,a=void 0!==t.options.onClick);var s=n?"a":"span",c=e.appendChild(document.createElement(s)),l=c.appendChild(document.createElement("small"));l.classList.add("name");var d=c.appendChild(document.createElement("small"));if(d.classList.add("hours"),c.title=t.name,n&&(c.href=t.options.url),r)for(var u in t.options.data)c.setAttribute("data-"+u,t.options.data[u]);a&&c.addEventListener("click",function(e){t.options.onClick(t,p,e)}),c.className=o?"time-entry "+t.options["class"]:"time-entry",c.style.width=f(t),c.style.left=m(t),l.textContent=t.name,d.textContent=("0"+t.startDate.getHours()).substr(-2)+":"+("0"+t.startDate.getMinutes()).substr(-2)+" - "+("0"+t.endDate.getHours()).substr(-2)+":"+("0"+t.endDate.getMinutes()).substr(-2)}function f(t){var e=t.startDate,n=t.endDate,o=h(e,n);return o/v*100+"%"}function h(t,e){return(e.getTime()-t.getTime())/1e3/60/60}function m(t){var e=p.scope.hourStart,n=t.startDate.getHours()+t.startDate.getMinutes()/60,o=a(e,n);return o/v*100+"%"}var p=this.timetable,v=a(p.scope.hourStart,p.scope.hourEnd),E=document.querySelector(t);e(E),s(E),n(E),r(E),syncscroll.reset()}}}();

