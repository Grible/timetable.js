"use strict";var Datetable=function(){this.scope={dateStart:new Date(2016,9,3),dateEnd:new Date(2016,9,4)},this.locations=[],this.events=[]};Datetable.Renderer=function(t){if(!(t instanceof Datetable))throw new Error("Initialize renderer using a Datetable");this.datetable=t},function(){function t(t,e){return e.indexOf(t)!==-1}function e(t,e){var n=t instanceof Date&&e instanceof Date,o=t<e;return n&&o}function n(t,e){return new Date(e-t).getTime()}function o(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function a(t){var e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=e[t.getMonth()]+" "+t.getDate();return n}Datetable.prototype={setScope:function(t,n){if(!e(t,n))throw new RangeError("Datetable scope should consist of (start, end) in Date format");return this.scope.dateStart=t,this.scope.dateEnd=n,this},addLocations:function(e){function n(){return e instanceof Array}var o=this.locations;if(!n())throw new Error("Tried to add locations in wrong format");return e.forEach(function(e){if(t(e,o))throw new Error("Location already exists");o.push(e)}),this},addEvent:function(n,o,a,r,i){if(!t(o,this.locations))throw new Error("Unknown location");if(!e(a,r))throw new Error("Invalid date range: "+JSON.stringify([a,r]));var c="[object Object]"===Object.prototype.toString.call(i);return this.events.push({name:n,location:o,startDate:a,endDate:r,options:c?i:void 0}),this}},Datetable.Renderer.prototype={draw:function(t){function e(t){if(null===t)throw new Error("Datetable container not found")}function r(t){var e=t.appendChild(document.createElement("aside")),n=e.appendChild(document.createElement("ul"));i(n)}function i(t){for(var e=0;e<f.locations.length;e++){var n=t.appendChild(document.createElement("li")),o=n.appendChild(document.createElement("span"));o.className="row-heading",o.textContent=f.locations[e]}}function c(t){var e=t.appendChild(document.createElement("section")),n=e.appendChild(document.createElement("date"));d(n),l(n)}function d(t){for(var e=t.appendChild(document.createElement("header")),n=e.appendChild(document.createElement("ul")),o=!1,r=f.scope.dateStart;!o;){var i=n.appendChild(document.createElement("li")),c=i.appendChild(document.createElement("span"));c.className="date-label",c.textContent=a(r),r=new Date(r.getTime()+864e5),r>=f.scope.dateEnd&&(i=n.appendChild(document.createElement("li")),c=i.appendChild(document.createElement("span")),c.textContent="",o=!0)}}function l(t){var e=t.appendChild(document.createElement("ul"));e.className="room-timeline";for(var n=0;n<f.locations.length;n++){var o=e.appendChild(document.createElement("li"));s(f.locations[n],o)}}function s(t,e){for(var n=0;n<f.events.length;n++){var o=f.events[n];o.location===t&&u(o,e)}}function u(t,e){var n,o,a=void 0!==t.options,r=!1;a&&(n=void 0!==t.options.url,o=void 0!==t.options["class"],r=void 0!==t.options.data);var i=n?"a":"span",c=e.appendChild(document.createElement(i)),d=c.appendChild(document.createElement("small"));if(c.title=t.name,n&&(c.href=t.options.url),r)for(var l in t.options.data)c.setAttribute("data-"+l,t.options.data[l]);c.className=o?"date-entry "+t.options["class"]:"date-entry",c.style.width=p(t),c.style.left=h(t),d.textContent=t.name}function p(t){var e=t.startDate,o=t.endDate,a=n(e,o);return a/m*100+"%"}function h(t){var e=f.scope.dateStart,o=t.startDate,a=n(e,o);return a/m*100+"%"}var f=this.datetable,m=n(f.scope.dateStart,f.scope.dateEnd),v=document.querySelector(t);e(v),o(v),r(v),c(v)}}}();var Timetable=function(){this.scope={hourStart:9,hourEnd:17},this.locations=[],this.events=[]};Timetable.Renderer=function(t){if(!(t instanceof Timetable))throw new Error("Initialize renderer using a Timetable");this.timetable=t},function(){function t(t,n){return e(t)&&e(n)}function e(t){return n(t)&&o(t)}function n(t){return t===parseInt(t,10)}function o(t){return t>=0&&t<24}function a(t,e){return e.indexOf(t)!==-1}function r(t,e){var n=t instanceof Date&&e instanceof Date,o=t<e;return n&&o}function i(t,e){return e>=t?e-t:24+e-t}function c(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function d(t){var e=t<10?"0":"";return e+t+":00"}Timetable.prototype={setScope:function(e,n){if(!t(e,n))throw new RangeError("Timetable scope should consist of (start, end) in whole hours from 0 to 23");return this.scope.hourStart=e,this.scope.hourEnd=n,this},addLocations:function(t){function e(){return t instanceof Array}var n=this.locations;if(!e())throw new Error("Tried to add locations in wrong format");return t.forEach(function(t){if(a(t,n))throw new Error("Location already exists");n.push(t)}),this},addEvent:function(t,e,n,o,i){if(!a(e,this.locations))throw new Error("Unknown location");if(!r(n,o))throw new Error("Invalid time range: "+JSON.stringify([n,o]));var c="[object Object]"===Object.prototype.toString.call(i);return this.events.push({name:t,location:e,startDate:n,endDate:o,options:c?i:void 0}),this}},Timetable.Renderer.prototype={draw:function(t){function e(t){if(null===t)throw new Error("Timetable container not found")}function n(t){var e=t.appendChild(document.createElement("aside")),n=e.appendChild(document.createElement("ul"));o(n)}function o(t){for(var e=0;e<m.locations.length;e++){var n=t.appendChild(document.createElement("li")),o=n.appendChild(document.createElement("span"));o.className="row-heading",o.textContent=m.locations[e]}}function a(t){var e=t.appendChild(document.createElement("section")),n=e.appendChild(document.createElement("time"));r(n),l(n)}function r(t){for(var e=t.appendChild(document.createElement("header")),n=e.appendChild(document.createElement("ul")),o=!1,a=!1,r=m.scope.hourStart;!o;){var i=n.appendChild(document.createElement("li")),c=i.appendChild(document.createElement("span"));c.className="time-label",c.textContent=d(r),r!==m.scope.hourEnd||m.scope.hourStart===m.scope.hourEnd&&!a||(o=!0),24===++r&&(r=0,a=!0)}}function l(t){var e=t.appendChild(document.createElement("ul"));e.className="room-timeline";for(var n=0;n<m.locations.length;n++){var o=e.appendChild(document.createElement("li"));s(m.locations[n],o)}}function s(t,e){for(var n=0;n<m.events.length;n++){var o=m.events[n];o.location===t&&u(o,e)}}function u(t,e){var n,o,a=void 0!==t.options,r=!1;a&&(n=void 0!==t.options.url,o=void 0!==t.options["class"],r=void 0!==t.options.data);var i=n?"a":"span",c=e.appendChild(document.createElement(i)),d=c.appendChild(document.createElement("small"));if(c.title=t.name,n&&(c.href=t.options.url),r)for(var l in t.options.data)c.setAttribute("data-"+l,t.options.data[l]);c.className=o?"time-entry "+t.options["class"]:"time-entry",c.style.width=p(t),c.style.left=f(t),d.textContent=t.name}function p(t){var e=t.startDate,n=t.endDate,o=h(e,n);return o/v*100+"%"}function h(t,e){return(e.getTime()-t.getTime())/1e3/60/60}function f(t){var e=m.scope.hourStart,n=t.startDate.getHours()+t.startDate.getMinutes()/60,o=i(e,n);return o/v*100+"%"}var m=this.timetable,v=i(m.scope.hourStart,m.scope.hourEnd),E=document.querySelector(t);e(E),c(E),n(E),a(E)}}}();